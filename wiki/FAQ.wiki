#summary Frequently Asked Questions

If you're having trouble with `mod_pagespeed`, we'd love to hear about it on [http://groups.google.com/group/mod-pagespeed-discuss/ the mailing list].  But first, check below to see if your question has already been answered.

Please do not post new questions to this page; if you do they will be deleted and moved to the mailing list.  But if you spot a recurring theme on the mailing list, feel free to post the question *and answer* below on this page.

<wiki:toc max_depth="1" />

= When will you support my favorite OS/http server/protocol/ice cream flavor? =
While we have no dates to announce for upcoming releases, we definitely want to know what you think we should be working on.  Please click on the "Issues" tab, and search for your feature.  (If you don't find it, open a new issue and tag it "Type-Enhancement"). Then click on the Star icon in the top left of the Issue page.  That way, we'll know how many people are interested, and you'll get any updates we post about that feature.

= I installed mod_pagespeed; why isn't it rewriting any of my pages? =

  # Check the HTTP response headers from your page (e.g., run `curl -D - http://example.com`).  Look for a header like `X-Mod-Pagespeed: 0.9.0.0-215`.  If you don't see one, this means that Apache is not adding `mod_pagespeed` to the filter chain, meaning the problem is probably in your Apache `.conf` files. One possible cause for this is multiple references to {{{SetOutputFilter}}}: only one of those will win.  See http://httpd.apache.org/docs/current/mod/core.html#addoutputfilterbytype
  # It's possible that none of the active mod_pagepspeed rewriters found anything useful to rewrite in your page.  Try enabling more aggressive ones!
  # mod_pagespeed cannot optimize resources (css, js, or images) that are marked as cache-control:nocache or cache-control:private. If your default caching headers are marked as such, mod-pagespeed will not rewrite the resources.
  # mod_pagespeed cannot minify CSS files that it cannot parse, specifically it will fail on certain proprietary and CSS3 syntaxes (See issue 108).
  # We intentionally don't allow fetching and rewriting HTTPS resources (so we don't open up security holes in your server).

= I am using !WordPress and my pages are blank.  What gives? =

Disable compression in the !WordPress plugin, so that mod_pagespeed will process uncompressed HTML.  mod_pagespeed automatically adds mod_deflate to the filter after running, so the optimized HTML will be compressed before serving.

= I installed Apache 2.2 using cPanel, and can't get mod_pagespeed to work when I install from the .deb or .rpm.  Little help?=

In order to use mod_pagespeed packages (.rpm, .deb) from the [http://code.google.com/speed/page-speed/download.html download site] you must have installed Apache httpd from a package manager. If you compiled them from source (for example, using cPanel/!EasyApache) then you cannot use the packages. Instead you need to install from source using the instructions at HowToBuild.  If you try to install the .deb or .rpm you may either get an error at installation time, or you may simply discover that apache isn't running mod_pagespeed as you expect.

We have an [http://code.google.com/p/modpagespeed/issues/detail?id=109 open Enhancement] to make this easier for people using cPanel !EasyApache. You can also try to follow this tutorial: http://www.technomenace.com/2010/11/install-mod_pagespeed_in_apache_for_cpanel/ We have not tried this and cannot vouch for it, so let us know if it fails.

= mod_pagespeed broke my site; what do I do? =

First of all, sorry about that. We put a lot of work into validating our rewriters against a large corpus of websites and we disable filters that cause problems as soon as we can, but sometimes things slip through.

Second, please upgrade to the latest version; we are continually working on bug-fixes and turning off filters that break pages.

If it's still breaking your site, please post a bug at http://code.google.com/p/modpagespeed/issues/list . If you can, including the following information will make it much easier to diagnose:

  # Try appending {{{?ModPagespeed=off}}} to the URL. This de-activates mod_pagespeed module. If the site is still broken, it is not a rewrite or HTML parsing problem. It might be a configuration clash, please ask us at mod-pagespeed-discuss@googlegroups.com or file a bug.
  # If that fixed the site, try appending {{{?ModPagespeed=on&ModPagespeedFilters=}}} to the URL. This turns on mod_pagespeed, but no filters. If the site is broken now, it is an HTML parsing problem. Please let us know.
  # If the site still worked, try appending {{{?ModPagespeed=on&ModPagespeedFilters=foo}}} for various filters "foo". For example try:
{{{
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=extend_cache
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=combine_css
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=inline_css
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=inline_javascript
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=insert_img_dimensions
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=rewrite_images
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=rewrite_css
http://www.modpagespeed.com/?ModPagespeed=on&ModPagespeedFilters=rewrite_javascript
}}}
You may have to reload them a few times over several seconds to make sure they have had time to load sub-resources into cache and rewrite them. If one of these breaks your site, you now know which filter is at fault. Please [http://code.google.com/p/modpagespeed/issues/list post a bug] to let us know. You can disable that filter by adding a line to your pagespeed.conf file:
{{{
   ModPagespeedDisableFilters foo
}}}

= Apache will not restart unless I disable mod_pagespeed!  What's up with that? =

If you see error messages similar to this:
{{{
[Thu Nov 04 01:00:25 2010] [error] [1104/010025:ERROR:net/instaweb/apache/apr_statistics.cc(97)] Variable serf_fetch_cancel_count cannot create mutex: No space left on device /etc/apache2/mod_pagespeed/stats_mutex.serf_fetch_cancel_count
}}}
or
{{{
[Sat Oct 16 21:22:46 2010] [warn] pid file /usr/local/apache2/logs/httpd.pid
# overwritten -- Unclean shutdown of previous Apache run?
}}}

then Apache previously exited uncleanly, and mod_pagespesed left behind some shared memory segments that need to be cleaned.  Try this SharedMemoryCleanupScript.

= How do I clear the cache on my server? ==

Usually this should only be necessary if a new version of mod_pagespeed is installed, and the cache has invalid data from a previous version.  To clear the cache with minimal server downtime, type:

{{{
  sudo mkdir /var/mod_pagespeed/cache.old
  sudo /etc/init.d/apachectl stop
  sleep 2   # allow time for apache to terminate
  sudo mv /var/mod_pagespeed/cache/* /var/mod_pagespeed/cache.old
  sudo /etc/init.d/apachectl start
  sudo rm -rf  /var/mod_pagespeed/cache.old
}}}

These paths and commands are for Debian/Ubuntu; adjust accordingly for other distributions.

= Why is mod_pagespeed giving me errors in jquery or js_tinyMCE? =

Some Javascript libraries that are sensitive to their own names.  This sensitivity might result from a DOM search from javascript for its own script node.

To workaround this problem, use the *ModPagespeedDisallow* directive in the configuration file.

{{{
  ModPagespeedDisallow */jquery-ui-1.8.2.custom.min.js
  ModPagespeedDisallow */js_tinyMCE.js
}}}

This way mod_pagespeed can continue to operate on the other elements of the web page.

Note: This option was added in mod_pagespeed 0.9.11.1-271

= What's with all these 'serf' errors in my logs? =

This can happen when the DNS setup on the Apache server or the firewall prevents that host from being able to reference the js, css, and image files using the URLs from the HTML pages.  The solution is to use origin-mapping to indicate the host from which the resources should be fetched.

{{{
  ModPagespeedMapOriginDomain localhost www.myhost.com
}}}

This can also be used to improve the performance of mod_pagespeed when it is sitting behind a load balancer.  It may be preferable to use localhost to load the resources rather than going out to the load-balancer and back.

= Can I move mod_pagespeed's file-based cache into RAM? =

Why yes, you can.  mod_pagespeed uses the file system for its cache implementation.  There is no requirement that this be a physical disk.  Disk pressure will be reduced and performance may be improved by using a memory-based file system.

Put this in /etc/fstab, please change the uid & guid to the appropiate
user & group of your apache webserver, and the path to your needs.
Feel free to change the size (here it is 256Mb):

{{{
tmpfs /var/www/mod_pagespeed/cache tmpfs size=256m,mode=0775,uid=httpd,gid=httpd 0 0
}}}

Save it, and after that mount the tmpfs:

{{{
mount /var/www/mod_pagespeed/cache
}}}

----

Thanks to contributors on mod-pagespeed-discuss@googlegroups.com

  * yogeshsarkar@gmail.com
  * pdreissen@gmail.com